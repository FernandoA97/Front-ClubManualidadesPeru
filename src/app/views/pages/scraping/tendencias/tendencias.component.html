<div class="container mt-4">
  <h2 class="text-center mb-4">Tendencias - Google Trends Perú</h2>

  <!-- Botón para consultar -->
  <div class="text-center mb-4">
    <button
      class="btn btn-primary px-4"
      (click)="consultarTendencias()"
      [disabled]="isLoading">
      <span *ngIf="!isLoading">Consultar Tendencias</span>
      <span *ngIf="isLoading">
        <i class="spinner-border spinner-border-sm me-2"></i> Consultando...
      </span>
    </button>
  </div>

  <!-- Loader -->
  <div *ngIf="isLoading" class="text-center my-4">
    <p>Consultando tendencias en línea...</p>
  </div>

  <!-- Error -->
  <div *ngIf="!isLoading && error" class="alert alert-danger text-center">
    {{ error }}
  </div>

  <!-- Tabla -->
  <div *ngIf="!isLoading && !error && consultaRealizada && tendencias.length > 0" class="table-responsive">
    <table class="table table-striped table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th>#</th>
          <th>Tendencia</th>
          <th>Volumen</th>
          <th>Fecha de consulta</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let t of paginatedTendencias; index as i">
          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ t.tendencia }}</td>
          <td>{{ t.volumen | number }}</td>
          <td>{{ t.fecha_consulta }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Sin resultados -->
  <div *ngIf="!isLoading && consultaRealizada && tendencias.length === 0 && !error" class="text-center text-muted mt-4">
    <p>No se encontraron tendencias en esta consulta.</p>
  </div>

  <!-- Paginación -->
  <nav *ngIf="!isLoading && totalPages > 1" class="mt-3 d-flex justify-content-center">
    <ul class="pagination mb-0">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <a class="page-link" (click)="changePage(currentPage - 1)">Anterior</a>
      </li>

      <li
        class="page-item"
        *ngFor="let page of [].constructor(totalPages); index as i"
        [class.active]="currentPage === i + 1">
        <a class="page-link" (click)="changePage(i + 1)">{{ i + 1 }}</a>
      </li>

      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <a class="page-link" (click)="changePage(currentPage + 1)">Siguiente</a>
      </li>
    </ul>
  </nav>
</div>
